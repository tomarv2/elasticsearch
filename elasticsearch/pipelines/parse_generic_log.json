{
  "description": "Generic Log Parser",
  "processors": [
    {
      "grok": {
        "field": "source",
        "ignore_missing": true,
        "patterns": [
          "/var/log/containers/%{DATA:pod_name}_%{DATA:namespace}_%{GREEDYDATA:container_name}-%{DATA:container_id}.log"
        ]
      }
    },
    {
      "set": {
        "field": "unparsed",
        "value": "true"
      }
    },
    {
      "set": {
        "field": "message",
        "value": "{{log}}"
      }
    },
    {
      "remove": {
        "field": "beat.name"
      }
    },
    {
      "remove": {
        "field": "beat.hostname"
      }
    },
    {
      "remove": {
        "field": "beat.version"
      }
    },
    {
      "remove": {
        "field": "source"
      }
    },
    {
      "remove": {
        "field": "log"
      }
    }
  ]
}